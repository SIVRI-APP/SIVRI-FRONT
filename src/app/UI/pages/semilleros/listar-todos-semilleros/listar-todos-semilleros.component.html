<form [formGroup]="formulario" (ngSubmit)="onsubmit()" method="get">
  <div class="filter-box">

    <!--filtro de busqueda por id semillero, nombre semillero y estado-->
    <div class="row">

      <div class="col-sm">
        <label for="nombre" class="etiqueta-form"><strong>Nombre</strong></label>
        <input id="nombre" name="nombre" class="form-control" type="text" placeholder="Nombre" formControlName="nombre">
      </div>

      <div class="col-sm">
        <label for="correo" class="etiqueta-form"><strong>Correo</strong></label>
        <input id="correo" name="correo" class="form-control" type="text" placeholder="Correo del semillero"
          formControlName="correo" >
      </div>

      <div class="col-sm">
        <label for="estado" class="etiqueta-form"><strong>Estado</strong></label>
        <select id="estado" name="estado" class="form-select" formControlName="estado">
          <option value="" disabled selected hidden>Estado Semillero</option>
          @for (key of enumTranslationService.getEnumKeys(estadoSemilleroEnum); track $index) {
          <option [value]="key">{{enumTranslationService.getEnumValueByKey(estadoSemilleroEnum,key)}}</option>
          }
        </select>
      </div>
      <div class="col-sm">

      </div>
    </div>
    <div class="row">
      <div class="col controls">
        <label class="form-label listar">Mostrar
          <select class="form-select form-select-sm" formControlName="pageSize">
            @for (pag of paginas; track $index) {
            <option [value]="pag">{{pag}}</option>
            }
          </select>
        </label>

        <button type="button" class="secondaryBTN" (click)="limpiarCampos()">
          <div class="button-content">
            <span class="material-symbols-outlined secondaryBTN-icon">
              filter_alt
            </span>
            <span class="text">Limpiar</span>
          </div>
        </button>

        <button type="submit" class="primaryBTN">
          <div class="button-content">
            <span class="material-symbols-outlined primaryBTN-icon">
              search
            </span>
            <span class="text">Buscar</span>
          </div>
        </button>

      </div>
    </div>
    <div class="form-guide-line"></div>
  </div>

  <!-- Tabla Paginada  -->
  <!--app-datatable [datatableInputs]="datatableInputs" (changePageEmitter)="changePage($event)"
  (movePageEmitter)="movePage($event)"></!--app-datatable-->

  @if (datatableInputs.searchPerformed == true ) {
    @if (datatableInputs.paginacion.content.length > 0) {

        <div class="card shadow datatable">

            <div class="card-body">

                <div class="table-responsive table mt-2" id="dataTable" role="grid" aria-describedby="dataTable_info">
                    <table class="table my-0 table-striped" id="dataTable">

                        <thead>
                            <tr>
                                @for (tableHeader of datatableInputs.tableHeaders; track $index) {
                                    <th>{{tableHeader}}</th>
                                }
                                <th>Acciones</th>
                            </tr>
                        </thead>

                        <tbody>
                            @for (data of datatableInputs.paginacion.content; track data[datatableInputs.dataAttributes[0].name]) {
                                <tr>
                                    @for (attribute of datatableInputs.dataAttributes; track $index) {
                                        @if (enumTranslationService.isEnumType(attribute.type)) {
                                            <td>{{enumTranslationService.getEnumValueByKey(attribute.type, data[attribute.name])}}</td>
                                        }@else {
                                          @if (attribute.name === 'estado') {
                                            <td>
                                                <select name="estado" id="estado_{{data.id}}" >
                                                    <option value="{{data[attribute.name]}}" selected>{{data[attribute.name]}}</option>
                                                    <option value="Activo">Activo</option>
                                                    <option value="Inactivo">Inactivo</option>
                                                    <option value="Formulado">Formulado</option>
                                                </select>
                                            </td>
                                          } @else {
                                              <td>{{data[attribute.name]}}</td>
                                          }
                                            <!--td>{{data[attribute.name]}}</!--td-->
                                        }
                                    }
                                    <td><a [routerLink]="[data[datatableInputs.dataAttributes[0].name]]"><span class="material-symbols-outlined dataTableActionBtn">visibility</span></a>
                                      <a (click)="cambiarEstado([data[datatableInputs.dataAttributes[0].name]])"><span class="material-symbols-outlined dataTableActionBtn">edit</span></a>
                                    </td>
                                </tr>
                            }
                        </tbody>

                    </table>
                </div>

                <div class="row">
                    <div class="col-md-6 align-self-center">
                        <p id="dataTable_info" class="dataTables_info" role="status" aria-live="polite">{{calcularTextoVisualizacion()}}</p>
                    </div>
                    <div class="col-md-6">
                        <nav class="d-lg-flex justify-content-lg-end dataTables_paginate paging_simple_numbers">
                            <ul class="pagination">

                                <!-- Atras -->
                                @if (datatableInputs.paginacion.first) {
                                <li class="page-item disabled"><a class="page-link" aria-label="Previous"
                                        (click)="movePage('atras')"><span aria-hidden="true">«</span></a></li>
                                }@else {
                                <li class="page-item"><a class="page-link" aria-label="Previous"
                                        (click)="movePage('atras')"><span aria-hidden="true">«</span></a></li>
                                }

                                <!-- Paginas -->

                                @for (pageNumber of getPageNumbers(); track $index) {
                                <li class="page-item pagina"
                                    [class.active]="pageNumber === datatableInputs.paginacion.number + 1"><a class="page-link"
                                        (click)="changePage(pageNumber)">{{ pageNumber }}</a></li>
                                }

                                <!-- Adelante -->
                                @if (datatableInputs.paginacion.last) {
                                <li class="page-item disabled"><a class="page-link" aria-label="Next"
                                        (click)="movePage('adelante')"><span aria-hidden="true">»</span></a></li>
                                }@else {
                                <li class="page-item"><a class="page-link" aria-label="Next"
                                        (click)="movePage('adelante')"><span aria-hidden="true">»</span></a></li>
                                }

                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    }@else {
    <div class="icon-container">
        <span class="material-symbols-outlined giant-icon">
            scan_delete
        </span>
        <p class="file-description">No hay {{datatableInputs.domain}} disponibles asociados a esta busqueda.</p>
    </div>
    }
}@else {
    <div class="icon-container">
        <span class="material-symbols-outlined giant-icon">
            description
        </span>
        <p class="file-description">Visualiza registros de {{datatableInputs.domain}} llenando los campos del formulario.</p>
    </div>
}

</form>
